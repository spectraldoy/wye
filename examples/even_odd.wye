(* 
standard mutual recursion example to determine if
a given number is even or odd
*)

type parity = Odd | Even;

let determine_parity x = match x {
    _ if is_even x => Even,
    _ => Odd
};

let is_even x = match x {
    _ if x < 0 => is_even (0 - x),
    0 => true,
    1 => false,
    _ => is_odd (x - 1)
};

let is_odd x = match x {
    _ if x < 0 => is_odd (0 - x),
    0 => false,
    1 => true,
    _ => is_even (x - 1)
};
